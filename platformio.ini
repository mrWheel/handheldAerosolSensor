; platformio.ini
;
;— ESP32 + Arduino framework
;— Pin choices avoid ESP32 strapping pins (GPIO0,2,4,5,12,15) and flash pins (GPIO6–11).
;— Battery ADC uses ADC1 (GPIO34) so it keeps working even if WiFi were enabled.
;— SPI uses VSPI defaults for ESP32: MOSI=23, MISO=19, SCK=18.

[platformio]
workspace_dir = .pio.nosync
default_envs = esp32dev

[env:esp32dev]
platform = espressif32
board = esp32dev
framework = arduino

monitor_speed = 115200
upload_speed = 921600

;-- do NOT use 0, 2, 4, 5, 12, 15 (Strapping pins) or 6–11 (Flash pins)
build_flags =
  ;==================== Power & user input ====================
  ;— Power latch control (OUTPUT)
  -D GPIO_PIN_LATCH=25

  ;— User pushbutton (INPUT_PULLUP, LOW = pressed)
  -D GPIO_PIN_SWITCH=33


  ;==================== Battery measurement ====================
  ;— Battery voltage divider ADC input (ADC1)
  -D GPIO_PIN_BAT_ADC=34


  ;==================== SPS air quality sensor ====================
  ;— SPS I2C interface
  -D GPIO_PIN_SPS_SDA=21
  -D GPIO_PIN_SPS_SCL=22

  ;— SPS UART interface (UART2, hardware default pins)
  -D GPIO_PIN_SPS_UART_TX=17
  -D GPIO_PIN_SPS_UART_RX=16


  ;==================== E-paper display (SPI) ====================
  ;— SPI data pins (VSPI defaults)
  -D GPIO_PIN_EPD_MOSI=23
  -D GPIO_PIN_EPD_MISO=-1
  -D GPIO_PIN_EPD_SCK=18

  ;— E-paper control pins
  -D GPIO_PIN_EPD_CS=27
  -D GPIO_PIN_EPD_DC=19
  -D GPIO_PIN_EPD_RST=13
  -D GPIO_PIN_EPD_BUSY=32


  ;==================== User feedback ====================
  ;— Piezo buzzer (PWM via LEDC)
  -D GPIO_PIN_BUZZER_PWM=14


  ;==================== Application configuration ====================
  -D WARMUP_SECONDS=5
  -D MAX_METINGEN=5


  ;==================== ADC calibration ====================
  -D ADC_VREF_VOLTAGE=3.30f
  
  ;==================== Battery calibration ====================
  -D BAT_CAL_GAIN=0.94245f
  -D BAT_CAL_OFFSET=0.48763f

  ;==================== Library configuration ====================
  -D DISABLE_DIAGNOSTIC_OUTPUT
  -D CORE_DEBUG_LEVEL=0

lib_deps =
  zinggjm/GxEPD2@^1.6.5
  adafruit/Adafruit GFX Library@^1.11.9
  adafruit/Adafruit BMP280 Library
	adafruit/Adafruit Unified Sensor
  sensirion/Sensirion Core @ ^0.7.2
  sensirion/sensirion-sps
  https://github.com/mrWheel/safeTimers.git
;  lbernstone/Tone32 @ ^1.0.0
