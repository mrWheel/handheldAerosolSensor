; platformio.ini
;
;— ESP32 + Arduino framework
;— Pin choices avoid ESP32 strapping pins (GPIO0,2,4,5,12,15) and flash pins (GPIO6–11).
;— Battery ADC uses ADC1 (GPIO34) so it keeps working even if WiFi were enabled.
;— SPI uses VSPI defaults for ESP32: MOSI=23, MISO=19, SCK=18.

[platformio]
workspace_dir = .pio.nosync
default_envs = esp32dev

[env:esp32dev]
platform = espressif32
board = esp32dev
framework = arduino

monitor_speed = 115200
upload_speed = 921600

build_flags =
  ;— Power latch (OUTPUT) - safe non-strapping pin
  -D GPIO_PIN_LATCH=25

  ;— User switch (INPUT_PULLUP) - safe non-strapping pin
  -D GPIO_PIN_SWITCH=33

  ;— Battery ADC (INPUT only is OK) - ADC1 pin (recommended)
  -D GPIO_PIN_BAT_ADC=34

  ;— SPS30 I2C (default ESP32 I2C pins, both non-strapping)
  -D GPIO_PIN_SPS30_SDA=21
  -D GPIO_PIN_SPS30_SCL=22

  ;— E-paper SPI (VSPI defaults, all non-strapping)
  -D GPIO_PIN_EPD_MOSI=23   ; (blue) DIN
  -D GPIO_PIN_EPD_MISO=-1   ; (n.c.)
  -D GPIO_PIN_EPD_SCK=18    ; (yellow)

  ;— E-paper control pins (all non-strapping)
  -D GPIO_PIN_EPD_CS=27     ; (orange) 
  -D GPIO_PIN_EPD_DC=17     ; (green) TX2
  -D GPIO_PIN_EPD_RST=16    ; (white) RX2
  -D GPIO_PIN_EPD_BUSY=32   ; (purple)

  ;— App config
  -D WARMUP_SECONDS=3
  -D MAX_METINGEN=2

  ;— ADC reference voltage (typical ESP32 board is 3.3V; calibrate if needed)
  -D ADC_VREF_VOLTAGE=3.30f

lib_deps =
  zinggjm/GxEPD2@^1.6.5
  adafruit/Adafruit GFX Library@^1.11.9
  https://github.com/Sensirion/arduino-sps.git
  https://github.com/mrWheel/safeTimers.git
